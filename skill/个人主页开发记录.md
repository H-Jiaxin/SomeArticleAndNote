# 个人网站开发

> 2025年2月26日

使用新学习的react框架进行个人网站的开发，后端使用springboot使用两个服务，一个是基础网站服务，一个用于我自己管理文章以及相应数据，这个网站主要用于个人记录生活以及分享一些技术文章，学习前端开发

# 设计数据库的结构

对于一个非盈利性的个人网站来说，一般这里并不需要很复杂的数据库设计，因此我只创建了三张表，一张用来存储我的文章信息，还有一张用来存储评论信息，剩下一张用来保存我的网站创建历史(评论功能现在打算推迟)

# 设计前端网页

打算使用响应式设计，使用react的框架，没有什么灵感。

# 设计后端

先进行基础服务的后端设计

2025-3-17目前已经完成了大部分的后端，时间不是很多，更多的功能打算正式上线之后再慢慢添加

# 上传文章到github

我打算在github上存储我的文章，然后在服务器上进行`git push`来获取我最新的文章，但是发现上传上去的文章图片无法正常显示，尝试很多办法，使用相对路径，发现反斜杠被识别成了`%5c`最后通过将反斜杠修改为`/`问题才得以解决，（后记）这个存储方法被我否决了，打算使用后端处理文件并保存至服务器，图片目前还没存储，但是之后的更新可能会在后端读取前端上传的文件，找到图片并保存在服务器目录

# 框架基本完成

目前前端的工作基本已经完成了，考虑进行后端接口的开发，查询了一些资料了解到文章的储存方式不太方便，CDN应该是较好的处理方法，但是目前不是很了解CDN的搭建方法，想要考虑将文件交由后端处理，不过当务之急是先解决我发布文章的功能，打算另外创建一个服务来用以后台管理

# 文章存储问题

直到目前为止，我仍然没有找到一个合适的存储文章的办法，想了很多都没法很好地解决文章的图片存储的问题，搭建CDN的话成本较高，还有一种办法是将图片使用base64编码直接放进markdown文件中，考虑到markdown文件的加载以及图片转码的问题，不建议使用这个方法，目前暂定使用后端将图片存储到特定位置（一个相对路径），再由markdown读取

# 在react中的浏览器标签的问题

为了实现不同页面的浏览器标题不同，可以使用js中的`document.title`

```jsx
useEffect(()=>{
    document.title = 'tittle';
},[])
```

# 设计接口

为了实现更多功能，我打算记录一下我写的以及我将来要写的接口,  

## 服务端接口

| 接口名               | 参数        | 功能                                           |
|:-----------------:| --------- | -------------------------------------------- |
| getArticle        | label num | 获取文章,如果`num`为0则代表获取所有数据,`label`为“all”时获取所有类型 |
| getArticleContent | id        | 根据id来获取文章的内容                                 |
| getEvent          | 无参数       | 获取网站创建的历史                                    |

## 管理端接口

管理端可以使用服务端的一些接口，比如`getArtcle`获取文章的基本信息`getArticleContent`获取文章内容等

| id  | api                | param    | usage                                          |
|:---:|:------------------:| -------- | ---------------------------------------------- |
| 1   | editArticleInfo    | id       | 修改对应文章的基本信息                                    |
| 2   | editArticleContent | id       | 修改文章内容， ~~直接在后端修改没有好用的编辑器可能比较困难，考虑删除这个功能或者优化~~ |
| 3   | deleteArticle      | id       | 删除文章，数据库中删除记录不删除内容，再添加一个强制删除内容的选项              |
| 4   | addArticle         | 数据库中所需参数 | 根据参数新建索引，查看内容检查是否添加成功                          |

# 前后端交互的一些问题

当我尝试开发添加文章的功能时，发现如果使用post请求向后端发送带文件的数据时，后端会返回406错误，不接受参数，花了好几天的时间，最后才知道原来是maven依赖出了问题

# 在测试接口的时候发现了一些问题

当我使用管理端的添加文章的功能时有时候会导致重复提交，所以决定在添加文章的同时查询是否有这一条记录

# 部署问题

本地网站搭建完成，数据库也迁移到了服务器中，同时为了方便管理，我在服务器中开放了一个可以供我本地访问文章数据库的用户，在部署网站时由于具有nginx部署经验，很快完成了部署，目前还没有进行ICP备案，只能通过IP访问，接下来等备案完成就可以申请SSL证书了

# ICP备案问题

经过7天等待，备案顺利通过，成功使用域名访问，同时使用开源项目[acmesh-official/acme.sh: A pure Unix shell script implementing ACME client protocol](https://github.com/acmesh-official/acme.sh)成功申请了SSL证书
